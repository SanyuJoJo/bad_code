1.执行策略

```
Get-ExecutionPolicy
```

```
Set-ExecutionPolicy
```

2.powershell编辑器
![[image-2023070907.png]]


基本语法：
对缩进不敏感
没有强制的分号
以{}作为代码块
保留字和命令必须是大小写区分的




## 1.变量

$a=1
clear-variable 删除变量
GetType(a)      获得变量类型
$global:a=1 全局变量
$script:a=1 脚本变量

```
| 编号 | 变量     | 描述                 |
|:-------|:------- |:----------------|
|1| $$|此变量用于表示会话接收到的最后一行中的最后一个令牌。|
|2 | $? | 此变量用于表示最后一个操作的执行状态。如果没有错误，则返回True，否则返回False。|
|  3 | $^ |此变量用于表示会话接收到的最后一行中的第一个令牌。|
|  4 |$_ |此变量充当$PSItem，它在管道对象中包含当前对象。 |
|  5 | $args| 此变量包含未声明参数的值的数组，这些值传递给脚本，函数或脚本块。|
|  6 | $ConsoleFileName|此变量用于表示控制台文件的路径，该文件最近在会话中使用。|
|  7 |$Error| 此变量用于包含代表最新错误的错误对象数组。|
|  8 | $Event| 此变量用于包含PSEventArgs的对象。PSEventArgs是用于表示正在处理的事件的对象。|
|  9 | $EventSubscriber| 此变量用于包含PSEventSubscriber的对象。该对象包含正在处理的事件的事件订阅者。 |
| 10 | $EventArgs  | 此变量用于包含一个对象，该对象表示第一个事件的参数。 |
| 11 | $false     | 此变量用于表示False。   |
| 12 | $foreach  | 此变量用于包含ForEach循环的枚举数。该变量仅在执行ForEach循环时存在。并在循环完成后删除。 |
| 13 | $Home  | 此变量用于表示用户主目录的完整路径  |
| 14 | $input | 此变量包含一个枚举器，该枚举器枚举传递给该函数的所有输入。它仅适用于脚本块和功能。 |
| 15 | $Host     | 此变量包含一个对象，该对象显示Windows PowerShell的当前主机应用程序。       |
| 16 |$IsLinux   |如果当前会话在Linux操作系统上运行，则此变量值为$True，否则为$False。 |
| 17 |$IsWindows   | 如果当前会话在Windows操作系统上运行，则此变量值为$True，否则为$False。                             |
| 18 |$IsMacOS  | 如果当前会话在MacOS操作系统上运行，则此变量值为$True，否则为$False。  |
| 19 | $null | 此变量用于表示null值或空值。可以使用它来表示脚本和命令中缺少或未定义的值。 |
| 20 | $PID |此变量显示进程的PID，该进程正在托管当前PowerShell的会话。|
| 21 | $PSItem| 此变量充当$_，它在管道对象中包含当前对象。|
| 22 | $PSHome| 此变量表示Windows PowerShell安装目录的完整路径。|
| 23 | $PSVersionTable | 此变量用于表示只读哈希表，该哈希表显示有关当前会话中运行的PowerShell版本的详细信息。 |
| 24 |$PWD| 此变量用于包含路径对象，该路径对象显示当前目录的完整路径。 |
| 25 |$ShellId| 此变量用于表示当前Shell的标识符。 |

```

``` 
1.$$
此变量用于表示会话接收到的最后一行中的最后一个令牌。
2.$?
此变量用于表示最后一个操作的执行状态。如果没有错误，则返回True，否则返回False。
3.$^
此变量用于表示会话接收到的最后一行中的第一个令牌。
4.$_
此变量充当$PSItem，它在管道对象中包含当前对象。
5.$args
此变量包含未声明参数的值的数组，这些值传递给脚本，函数或脚本块。
6.$ConsoleFileName
此变量用于表示控制台文件的路径，该文件最近在会话中使用。
7.$Error
此变量用于包含代表最新错误的错误对象数组。
8.$Event
此变量用于包含PSEventArgs的对象。PSEventArgs是用于表示正在处理的事件的对象。
9.$EventSubscriber
此变量用于包含PSEventSubscriber的对象。该对象包含正在处理的事件的事件订阅者。
10.$EventArgs
此变量用于包含一个对象，该对象表示第一个事件的参数。
11.$false
此变量用于表示False。
12.$foreach
此变量用于包含ForEach循环的枚举数。该变量仅在执行ForEach循环时存在。并在循环完成后删除。
13.$Home
此变量用于表示用户主目录的完整路径
14.$input
此变量包含一个枚举器，该枚举器枚举传递给该函数的所有输入。它仅适用于脚本块和功能。
15.$Host
此变量包含一个对象，该对象显示Windows PowerShell的当前主机应用程序。
16.$IsLinux
如果当前会话在Linux操作系统上运行，则此变量值为$True，否则为$False。
17.$IsWindows
如果当前会话在Windows操作系统上运行，则此变量值为$True，否则为$False。
18.$IsMacOS
如果当前会话在MacOS操作系统上运行，则此变量值为$True，否则为$False。
19.$null
此变量用于表示null值或空值。可以使用它来表示脚本和命令中缺少或未定义的值。
20.$PID
此变量显示进程的PID，该进程正在托管当前PowerShell的会话。
21.$PSItem
此变量充当$_，它在管道对象中包含当前对象。
22.$PSHome
此变量表示Windows PowerShell安装目录的完整路径。
23.$PSVersionTable
此变量用于表示只读哈希表，该哈希表显示有关当前会话中运行的PowerShell版本的详细信息。
24.$PWD
此变量用于包含路径对象，该路径对象显示当前目录的完整路径。
25.$ShellId
此变量用于表示当前Shell的标识符。

```



## 2.对象的集合
### 2.1 数组
#### 1.创建和初始化数组
要在powershell中声明数组，可以使用赋值运算符将多个值分配给变量。逗号分隔存储在数组中的值。
以下语句是声明数组变量的语法：
```
variable_name = value1,value2,value3,...,valueN
```
示例：要创建和初始化$k数组，该数组包含5个整数值：10,15,20,50,99.在powershell中键入以下命令：
```
$k = 10,15,20,50,99
```
还可以使用范围运算符来初始化数组
示例：要创建和初始化数组$arr,该数组包含从2到10的值
```
$arr = 2..10
```

#### 2.访问数组袁术
eg1：假设数组$array1包含：11,20,30,50,66,99显示数组所有值：
```
$array1 = 11,20,30,50,66,99
$array1
```
还可以使用索引号从数组访问元素，将索引号括在方括号中
``` 
$variable_name [index_number]
```
访问3-6元素
```
$array[2..5]
```
使用负数访问数组的最后一部分,最后一个元素访问
```
$array[-1]
```

要以索引号升序显示数组最后四个元素
```
$array[-4..-1]
```
#### 3.数组大小
获取数组长度
```
$varible_name.Length
```
eg:如果创建一个新数组$a,其中包含5个元素, 数组长度为
```
$a.Length
```

#### 4.数组的操作
更改数组的值
```
$p[2]=20
```
使用+=将值添加到数组
``` 
$variable_name += value
```
``` 
$a+=15
```

#### 5.初始化一个空数组
```
$variable_name = @()
```

#### 6.从数组中删除元素
删除第一个和最后一个
```
$array = 20,25,35,50,68
$array = ($array[1] $array[2] $array[3])
```

### 2.2 字典
#### 1.语法
创建hash语法
```
$variable_name = @{ <key1> = <value>; <key2> = <value2>;.....;<KeyN> = <valueN>;}
```
创建有序字典
```
$variable_name = {order}@{<key1> = <value1>;}
```