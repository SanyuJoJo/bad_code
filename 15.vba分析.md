宏样本分析步骤
1.打开office文档
2.不要启用代码
	流式隐藏：
	按住shift键不放，鼠标左键单即启用内容
3.直接在视图->宏->查看宏
	或者alt+f11
4.现在就能看到代码了
	如果看不到
	(作业 找一个有vba)
	vba代码有保护
	http://jingyan.baidu.com/article/1876c85266a8f8890b13768e.html
5.找auto_open()
找auto_close()
github.com/TonyChen56?tab=repositories

``` python
import base64
a = "abcdefg"
b = a.base64encode()
b = iafikrnfcikurfhirn
```

6.分析

恶意vba和普通vba的区别：
恶意vba首要的要求是触发(最优解是无条件触发)
普通vba(根据自己的需求，选择性地使用)
由于vba代码在office环境找中是不存在编译的，所以能看到源代码，所以代码混淆就非常重要


混淆：
名字或者过程(goto)
如果存在excel文件或者word文件里面有些元素也可以和vba代码做结合

``` vba
Sub CallSeries()
	Dim intI As Interger
	intI =1
	Eval (Chr(65) &"()")
End Sub
Function a()
	VBA.MsgBox("aaaaaa")
End Function
```


如果说我们自己写恶意功能的宏，然后看报不报毒
1.识别是否
	先写一个正常的宏 
2.那么就去找敏感字符的替代，编码，加密
3.找函数
怎么找函数
统计一下自己的样本里面写了几个函数
分别列出，逐个执行，查看情况
	createthreat


函数替换

行为：
1.思考自己要达到的目的(最终的影响)
2.收集这些影响能实现的方式
	api
	命令行
	shellcode
	添加用户
		命令行：net user add 实现的方式1
		注册表操作 实现方式2
		shellcode 实现方式3

https://www.exploit-db.com/